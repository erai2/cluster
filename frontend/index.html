
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>FortuneAI 문서 시스템</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; background: #f5f5f5; }
    .container { background: white; padding: 2rem; border-radius: 10px; max-width: 600px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    input[type="file"] { display: block; margin-bottom: 1rem; }
    ul { list-style-type: none; padding: 0; }
    li { margin: 0.5rem 0; display: flex; justify-content: space-between; align-items: center; }
    button { margin-left: 1rem; }
  </style>
</head>
<body>
<div class="container">
  <h2>📄 문서 업로드 및 관리</h2>
  <input type="file" id="fileInput">
  <button onclick="uploadFile()">업로드</button>
  <h3>📂 업로드된 문서</h3>
  <ul id="fileList"></ul>
  <h3>💬 질문하기</h3>
  <input type="text" id="questionInput" placeholder="질문을 입력하세요" style="width:100%">
  <button onclick="askQuestion()">질문하기</button>
  <pre id="answerOutput" style="background:#eee; padding:1rem; margin-top:1rem;"></pre>
</div>
<script>
  const apiBase = "http://localhost:8000";
  async function uploadFile() {
    const fileInput = document.getElementById("fileInput");
    const file = fileInput.files[0];
    const formData = new FormData();
    formData.append("file", file);
    await fetch(`${apiBase}/upload`, { method: "POST", body: formData });
    alert("✅ 업로드 완료");
    listFiles();
  }
  async function listFiles() {
    const res = await fetch(`${apiBase}/files`);
    const data = await res.json();
    const ul = document.getElementById("fileList");
    ul.innerHTML = "";
    data.files.forEach(fname => {
      const li = document.createElement("li");
      li.textContent = fname;
      const btn = document.createElement("button");
      btn.textContent = "삭제";
      btn.onclick = () => deleteFile(fname);
      li.appendChild(btn);
      ul.appendChild(li);
    });
  }
  async function deleteFile(fname) {
    await fetch(`${apiBase}/delete/${fname}`, { method: "DELETE" });
    alert("🗑️ 삭제 완료");
    listFiles();
  }
  async function askQuestion() {
    const question = document.getElementById("questionInput").value;
    const res = await fetch(`${apiBase}/query`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question })
    });
    const data = await res.json();
    document.getElementById("answerOutput").textContent = data.answer || "❌ 응답 없음";
  }
  window.onload = listFiles;
</script>
</body>
</html>
